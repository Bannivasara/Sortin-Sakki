<html>
<head>
	<meta charset="UTF-8">
	<title>Sorolan huumorit</title>
	<link rel="stylesheet" type="text/css" href="../tyylit/style.css">
	<link rel="stylesheet" type="text/css" href="style/style.css">
	<link rel="icon" type="image/svg+xml" href="../tyylit/fav.ico">
	<meta name="description" content="Sorolan huumorit lÃ¶ytyvÃ¤t tÃ¤Ã¤ltÃ¤.">
	<meta name="keywords" content="Sorola, Sortin Sakki, huumori">
</head>
<body>
	<div class="banner">
		<h1 class="sorola">Sorolan Huumorikuvat</h1>
		<button id="teeman-vaihto" class="nappula" style="width: auto; padding: 10px 20px;">ğŸŒ™ Vaihda teema</button>
	</div>
	<p class="saate">LisÃ¤ilen tÃ¤nne hauskoja kuvia, joita olen vuosien aikana lÃ¶ytÃ¤nyt. Kaikkea ei tarvitse tajuta eikÃ¤ varsinkaan ottaa vakavasti. :)</p>
	<div id="lightbox" onclick="this.style.display='none'">
		<img id="lightbox-img" src="" alt="Suurennos">
	</div>
	<div id="kuva-grid" class="grid"></div>
    <div id="lataus-vahti"></div> <script>
        let kaikkiKuvat = [];
        let naytettyja = 0;
        const erakoko = 15;

        async function alusta() {
            try {
                // LisÃ¤tÃ¤Ã¤n timestamp, jotta selain ei kÃ¤ytÃ¤ vanhaa vÃ¤limuistia (estÃ¤Ã¤ .la-virheet)
                const res = await fetch('kuvat.json?v=' + Date.now());
                kaikkiKuvat = await res.json();
                
                lataaEra(); // Ladataan ekat 15

                // IntersectionObserver hoitaa dynaamisen latauksen
                const observer = new IntersectionObserver((entries) => {
                    if (entries[0].isIntersecting && naytettyja < kaikkiKuvat.length) {
                        lataaEra();
                    }
                }, { threshold: 0.1 });

                observer.observe(document.getElementById('lataus-vahti'));
            } catch (e) {
                console.error("Virhe: Varmista ettÃ¤ olet sorola.fi osoitteessa!", e);
            }
        }

        function lataaEra() {
			const grid = document.getElementById('kuva-grid');
			const seuraavat = kaikkiKuvat.slice(naytettyja, naytettyja + erakoko);
			
			seuraavat.forEach(kuvaNimi => {
				const kortti = document.createElement('div');
				kortti.className = 'huumori-kortti';
				
				const img = document.createElement('img');
				img.src = `kuvat/${kuvaNimi}`;
				img.loading = "lazy";
				img.alt = "Huumori";
				
				// Klikkaus avaa suurennoksen
				img.onclick = () => {
					document.getElementById('lightbox-img').src = img.src;
					document.getElementById('lightbox').style.display = 'flex';
				};
				
				kortti.appendChild(img);
				grid.appendChild(kortti);
			});

        alusta();
    </script>
    <script src="../tyylit/teemat.js"></script>
	<!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "15c457e00da24cef9e3ca960ddde17c4"}'></script><!-- End Cloudflare Web Analytics -->
</body>
</html>
