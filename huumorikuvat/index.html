<html>
<head>
	<meta charset="UTF-8">
	<title>Sorolan huumorit</title>
	<link rel="stylesheet" type="text/css" href="../tyylit/style.css">
	<link rel="stylesheet" type="text/css" href="style/style.css">
	<link rel="icon" type="image/svg+xml" href="../tyylit/fav.ico">
	<meta name="description" content="Sorolan huumorit l√∂ytyv√§t t√§√§lt√§.">
	<meta name="keywords" content="Sorola, Sortin Sakki, huumori">
</head>
<body>
	<div class="banner">
		<h1 class="sorola">Sorolan Huumorikuvat</h1>
		<button id="teeman-vaihto" class="nappula" style="width: auto; padding: 10px 20px;">üåô Vaihda teema</button>
	</div>
	<p class="saate">Lis√§ilen t√§nne hauskoja kuvia, joita olen vuosien aikana l√∂yt√§nyt. Kaikkea ei tarvitse tajuta eik√§ varsinkaan ottaa vakavasti. :)</p>
	<div id="lightbox" onclick="this.style.display='none'">
		<img id="lightbox-img" src="" alt="Suurennos">
	</div>
	<div id="kuva-grid" class="grid"></div>
    <div id="lataus-vahti"></div> 
	<script>
        let kaikkiKuvat = [];
        let naytettyja = 0;
        const erakoko = 15;

        async function alusta() {
            try {
                // Lis√§t√§√§n timestamp v√§limuistin ohittamiseksi
                const res = await fetch('kuvat.json?v=' + Date.now());
                kaikkiKuvat = await res.json();
                
                lataaEra(); // Ladataan ekat 15

                const observer = new IntersectionObserver((entries) => {
                    if (entries[0].isIntersecting && naytettyja < kaikkiKuvat.length) {
                        lataaEra();
                    }
                }, { threshold: 0.1 });

                observer.observe(document.getElementById('lataus-vahti'));
            } catch (e) {
                console.error("Virhe ladattaessa kuvia:", e);
            }
        }

        function lataaEra() {
            const grid = document.getElementById('kuva-grid');
            const seuraavat = kaikkiKuvat.slice(naytettyja, naytettyja + erakoko);
            
            seuraavat.forEach(kuvaNimi => {
                const kortti = document.createElement('div');
                kortti.className = 'huumori-kortti';
                
                const img = document.createElement('img');
                img.src = `kuvat/${kuvaNimi}`;
                img.loading = "lazy";
                img.alt = "Huumori";
                
                img.onclick = () => {
                    document.getElementById('lightbox-img').src = img.src;
                    document.getElementById('lightbox').style.display = 'flex';
                };
                
                kortti.appendChild(img);
                grid.appendChild(kortti);
            });
            
            // T√ÑM√Ñ PUUTTUI: P√§ivitet√§√§n laskuri ja suljetaan funktio
            naytettyja += erakoko;
        }

        alusta();
    </script>
    <script src="../tyylit/teemat.js"></script>
	<!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "15c457e00da24cef9e3ca960ddde17c4"}'></script><!-- End Cloudflare Web Analytics -->
</body>
</html>
